<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knela - Tienda de Comida</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <style>
   
    </style>
</head>
<body>
    <header class="topbar">
        <div class="container">
            <div class="logo"><img src="/img/logo_knela.png" alt="logo"></div>
            <div class="welcome-message" id="welcomeMessage">
                <!-- Se llenar√° din√°micamente -->
            </div>
            <button class="cart-btn" onclick="toggleCart()">
                <span class="material-symbols-outlined">shopping_cart</span>
                Carrito
                <span class="cart-badge" id="cartBadge" style="display: none;">0</span>
            </button>
        </div>
    </header>

    <section class="hero-section">
        <div class="container">
            <div class="hero-content">
                <div class="hero-text">
                    <h1>Panader√≠a & deli con sabor <span>artesanal</span></h1>
                    <p>Ingredientes frescos, recetas caseras y env√≠os el mismo d√≠a. Descubr√≠ tus favoritos y recib√≠ en casa.</p>
                    <div class="hero-buttons">
                        <a href="#productos" class="btn-primary">Ver productos</a>
                        <a href="#ofertas" class="btn-secondary">Ofertas de hoy</a>
                    </div>
                </div>
                <div class="hero-image">
                    <img src="/Admin/knela.png" alt="Mesa con panes y caf√©">
                </div>
            </div>
        </div>
    </section>

    <div class="container">
        <div class="filters">
            <div class="search-box">
                <span class="material-symbols-outlined">search</span>
                <input type="text" id="searchInput" placeholder="Buscar productos..." oninput="filterProducts()">
            </div>
            <select id="categoryFilter" onchange="filterProducts()">
                <option value="">Todas las categor√≠as</option>
                <option value="dulce">Dulce</option>
                <option value="salado">Salado</option>
                <option value="bebida">Bebida</option>
            </select>
        </div>

        <div id="productsContainer" class="products-grid">
            <!-- Los productos se cargar√°n aqu√≠ -->
        </div>
    </div>

    <!-- Modal del Carrito -->
    <div id="cartModal" class="cart-modal">
        <div class="cart-modal-content">
            <div class="cart-modal-header">
                <h2>üõí Tu Carrito</h2>
                <button class="cart-close" onclick="toggleCart()">√ó</button>
            </div>
            
            <div id="cartItems" class="cart-items">
                <!-- Items del carrito -->
            </div>

            <div class="cart-total">
                <div class="cart-total-row">
                    <span>Total Items:</span>
                    <span id="cartTotalItems">0</span>
                </div>
                <div class="cart-total-row final">
                    <span>Total:</span>
                    <span id="cartTotalPrice">Gs. 0</span>
                </div>
            </div>

            <button class="cart-checkout" onclick="checkout()">
                Proceder al Pago
            </button>
        </div>
    </div>

    <footer>
        <div class="container">
            <div><b>Knela</b> ¬© 2025 ‚Äì Sistema de Gesti√≥n</div>
        </div>
    </footer>

    <script>
        // Configuraci√≥n
        const USER_NAME = "$NombreUsuario"; // Reemplazar con el nombre real del usuario
        const USER_TITLE = "$CategoriaUsuario"; // Reemplazar con el t√≠tulo real del usuario (Sr./Sra.)

        // Productos de ejemplo
        const allProducts = [
            { id: 1, nombre: "Pan Integral", categoria: "salado", precio: 15000, imagen: "https://images.unsplash.com/photo-1509440159596-0249088772ff?w=400", unidades: 10 },
            { id: 2, nombre: "Croissant", categoria: "dulce", precio: 18000, imagen: "https://images.unsplash.com/photo-1555507036-ab1f4038808a?w=400", unidades: 15 },
            { id: 3, nombre: "Caf√© Latte", categoria: "bebida", precio: 22000, imagen: "https://images.unsplash.com/photo-1461023058943-07fcbe16d735?w=400", unidades: 20 },
            { id: 4, nombre: "Empanada", categoria: "salado", precio: 12000, imagen: "https://images.unsplash.com/photo-1601050690597-df0568f70950?w=400", unidades: 25 },
            { id: 5, nombre: "Tarta de Manzana", categoria: "dulce", precio: 35000, imagen: "https://images.unsplash.com/photo-1535920527002-b35e96722eb9?w=400", unidades: 8 },
            { id: 6, nombre: "Jugo Natural", categoria: "bebida", precio: 20000, imagen: "https://images.unsplash.com/photo-1600271886742-f049cd451bba?w=400", unidades: 12 }
        ];

        let cart = [];

        // Determinar tema seg√∫n hora
        function getTimeTheme() {
            const hour = new Date().getHours();
            if (hour >= 6 && hour < 12) return 'morning';
            if (hour >= 12 && hour < 18) return 'afternoon';
            return 'night';
        }

        // Aplicar tema
        function applyTheme() {
            const theme = getTimeTheme();
            const body = document.body;
            const welcomeEl = document.getElementById('welcomeMessage');
            
            body.classList.remove('morning-theme', 'afternoon-theme', 'night-theme');
            body.classList.add(`${theme}-theme`);

            let greeting, icon;
            if (theme === 'morning') {
                greeting = `¬°Buenos d√≠as, ${USER_TITLE} ${USER_NAME}!`;
                icon = '‚òÄÔ∏è';
            } else if (theme === 'afternoon') {
                greeting = `¬°Buenas tardes, ${USER_TITLE} ${USER_NAME}!`;
                icon = 'üå§';
            } else {
                greeting = `¬°Buenas noches, ${USER_TITLE} ${USER_NAME}!`;
                icon = 'üåô';
            }

            welcomeEl.innerHTML = `${greeting} ${icon}`;
        }

        // Mostrar productos
        function displayProducts(products) {
            const container = document.getElementById('productsContainer');
            
            if (!products || products.length === 0) {
                container.innerHTML = '<div class="cart-empty"><p>No se encontraron productos</p></div>';
                return;
            }

            container.innerHTML = products.map(product => `
                <article class="product-card">
                    <img src="${product.imagen}" alt="${product.nombre}" class="product-image" onerror="this.src='https://via.placeholder.com/400x300?text=${product.nombre}'">
                    <div class="product-info">
                        <div class="product-name">${product.nombre}</div>
                        <div class="product-price">
                            <span class="current">Gs. ${parseInt(product.precio).toLocaleString('es-PY')}</span>
                        </div>
                        <div class="product-actions">
                            <button class="btn-buy" onclick="addToCart(${product.id})">
                                Agregar al carrito
                            </button>
                        </div>
                    </div>
                </article>
            `).join('');
        }

        // Filtrar productos
        function filterProducts() {
            const searchValue = document.getElementById('searchInput').value.toLowerCase();
            const categoryValue = document.getElementById('categoryFilter').value;

            const filtered = allProducts.filter(product => {
                const matchesSearch = product.nombre.toLowerCase().includes(searchValue);
                const matchesCategory = !categoryValue || product.categoria === categoryValue;
                return matchesSearch && matchesCategory;
            });

            displayProducts(filtered);
        }

        // Agregar al carrito
        function addToCart(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (product) {
                cart.push({...product, cartId: Date.now() + Math.random()});
                updateCart();
                alert(`‚úÖ ${product.nombre} agregado al carrito`);
            }
        }

        // Eliminar del carrito
        function removeFromCart(cartId) {
            cart = cart.filter(item => item.cartId !== cartId);
            updateCart();
        }

        // Actualizar UI del carrito
        function updateCart() {
            const badge = document.getElementById('cartBadge');
            const itemsContainer = document.getElementById('cartItems');
            const totalItems = document.getElementById('cartTotalItems');
            const totalPrice = document.getElementById('cartTotalPrice');

            // Badge
            if (cart.length > 0) {
                badge.style.display = 'block';
                badge.textContent = cart.length;
            } else {
                badge.style.display = 'none';
            }

            // Items
            if (cart.length === 0) {
                itemsContainer.innerHTML = '<div class="cart-empty"><p>Tu carrito est√° vac√≠o</p></div>';
            } else {
                itemsContainer.innerHTML = cart.map(item => `
                    <div class="cart-item">
                        <div class="cart-item-info">
                            <h4>${item.nombre}</h4>
                            <p>Gs. ${parseInt(item.precio).toLocaleString('es-PY')}</p>
                        </div>
                        <button class="cart-item-remove" onclick="removeFromCart(${item.cartId})">
                            Eliminar
                        </button>
                    </div>
                `).join('');
            }

            // Total
            const total = cart.reduce((sum, item) => sum + item.precio, 0);
            totalItems.textContent = cart.length;
            totalPrice.textContent = `Gs. ${total.toLocaleString('es-PY')}`;
        }

        // Toggle carrito
        function toggleCart() {
            const modal = document.getElementById('cartModal');
            modal.classList.toggle('active');
        }

        // Checkout
        function checkout() {
            if (cart.length === 0) {
                alert('Tu carrito est√° vac√≠o');
                return;
            }
            alert('üéâ Pedido confirmado! Total: Gs. ' + cart.reduce((sum, item) => sum + item.precio, 0).toLocaleString('es-PY'));
            cart = [];
            updateCart();
            toggleCart();
        }

        // Cerrar modal al hacer clic fuera
        document.getElementById('cartModal').addEventListener('click', function(e) {
            if (e.target === this) {
                toggleCart();
            }
        });

        // Inicializar
        window.addEventListener('DOMContentLoaded', () => {
            applyTheme();
            displayProducts(allProducts);
            updateCart();
            // Actualizar tema cada 30 minutos
            setInterval(applyTheme, 1800000);
        });
    </script>
</body>
</html>